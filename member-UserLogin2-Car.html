<!doctype html>

<html lang="en">

<head>

  <!-- Required meta tags -->

  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">



  <!-- google-sign-in -->

  <meta name="google-signin-scope" content="profile email">

  <meta name="google-signin-client_id" content="337166029484-nn0b2r6ealoiv3csuc2lb97ojarv39bb.apps.googleusercontent.com">



  <!-- Bootstrap CSS -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">

  <link rel="stylesheet" href="../css/all.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>



  <title>聯合名車展</title>

  <style>

  	.bg-cover{

  		background-position: center center;

  		background-size: cover;

  	}

  	.carousel-caption{

  		background-color: rgba(0, 0, 0, 0.5);

  	}

  	.job{

  		background-color: rgba(0, 0, 0, .5);

  	}



  	@media screen and (max-width: 768px){

  		.section5-text{

  			color: white;

  			background-color: rgba(0, 0, 0, 0.5);

  			margin-bottom: 15px;

  			padding: 15px;

  		}

  	}

  </style>



</head>

<body class="bg-light">



		<!-- ************section 1******************* -->

		<section class="bg-dark wow animate__fadeInTopRight" data-wow-duration="1s" data-wow-delay="0s" data-wow-iteration="1s">

			<div class="container">

				<!-- <div class="btn-group" role="group" aria-label="Basic example">

				  <button type="button" class="btn btn-primary">登出</button>

				  <button type="button" class="btn btn-primary">首頁</button>

				  <button type="button" class="btn btn-primary">更新密碼</button>

				</div> -->

				<form class="form-inline my-2 my-lg-0">

			    	<button type="button" class="btn btn-outline-warning mr-2" id="Logout">登出</button>

			    	<button type="button" class="btn btn-outline-warning mr-auto" id="Home">首頁</button>

			      <button type="button" class="btn btn-outline-info" data-toggle="modal" data-target="#UpdatePasswordModal">更新密碼</button>

		    </form>				

			</div>

		</section>	



		<!-- ************UpdatePasswordModal******************* -->

		<div class="modal fade" id="UpdatePasswordModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">



		  <div class="modal-dialog">

		    <div class="modal-content">

		      <div class="modal-header bg-warning">

		        <h5 class="modal-title font-weight-bold" id="exampleModalLabel">更改密碼</h5>

		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">

		          <span aria-hidden="true">&times;</span>

		        </button>

		      </div>



		      <div class="modal-body">

		        <div class="formpassword-group">

		        	<label for="">密碼</label>

	        		<input type="password" class="form-control" id="Updatepassword" name="Updatepassword" placeholder="請輸入新密碼">

		        </div>

		        <div id="err_password"></div>			        

			        

		        <div class="form-group">

		        	<label for="checkpassword">確認密碼</label>

	        		<input type="text" class="form-control" id="checkpassword" name="checkpassword" placeholder="請再次輸入密碼">

		        </div>

		        <div id="err_checkpassword"></div>



		      </div>



		      <div class="modal-footer">

		        <button type="button" class="btn btn-primary" id="u_ok_btn">確定</button>		        

		        <button type="button" class="btn btn-secondary" id="u_cancel_btn">取消</button>

		      </div>

		    </div>

		  </div>

		</div>

		<!-- ************section 2******************* -->
		<section class="wow animate__fadeIn" data-wow-duration="2s" data-wow-delay="0s" data-wow-iteration="3s">
			<div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
				  <ol class="carousel-indicators">
					<li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
					<li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
					<li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
					<li data-target="#carouselExampleCaptions" data-slide-to="3"></li>
					<li data-target="#carouselExampleCaptions" data-slide-to="4"></li>
				  </ol>
				  <div class="carousel-inner">
					<div class="carousel-item  bg-cover active" style="background-image: url(images/car35.png); height: 80vh;">	      
					  <div class="carousel-caption d-none d-md-block">
						<h5>相關圖片每次人生尋找浪漫組合點此體力方向教材，財政中文這一。</h5>
						<p>到來教育小學真正招生掌握享受服務常，工藝給我們自身承受各種你也利，經營許可證他的設備回頭相機所以對，必然對他屬性系列考。</p>
					  </div>
					</div>
					<div class="carousel-item  bg-cover" style="background-image: url(images/car32.png); height: 80vh;">	      
					  <div class="carousel-caption d-none d-md-block">
						<h5>相關圖片每次人生尋找浪漫組合點此體力方向教材，財政中文這一。</h5>
						<p>到來教育小學真正招生掌握享受服務常，工藝給我們自身承受各種你也利，經營許可證他的設備回頭相機所以對，必然對他屬性系列考。</p>
					  </div>
					</div>
					<div class="carousel-item  bg-cover" style="background-image: url(images/car33.png); height: 80vh;">	      
					  <div class="carousel-caption d-none d-md-block">
						<h5>相關圖片每次人生尋找浪漫組合點此體力方向教材，財政中文這一。</h5>
						<p>到來教育小學真正招生掌握享受服務常，工藝給我們自身承受各種你也利，經營許可證他的設備回頭相機所以對，必然對他屬性系列考。</p>
					  </div>
					</div>
					<div class="carousel-item  bg-cover" style="background-image: url(images/car39.png); height: 80vh;">	      
					  <div class="carousel-caption d-none d-md-block">
						<h5>相關圖片每次人生尋找浪漫組合點此體力方向教材，財政中文這一。</h5>
						<p>到來教育小學真正招生掌握享受服務常，工藝給我們自身承受各種你也利，經營許可證他的設備回頭相機所以對，必然對他屬性系列考。</p>
					  </div>
						</div>
					<div class="carousel-item  bg-cover" style="background-image: url(images/car37.png); height: 80vh;">	      
					  <div class="carousel-caption d-none d-md-block">
						<h5>相關圖片每次人生尋找浪漫組合點此體力方向教材，財政中文這一。</h5>
						<p>到來教育小學真正招生掌握享受服務常，工藝給我們自身承受各種你也利，經營許可證他的設備回頭相機所以對，必然對他屬性系列考。</p>
					  </div>
					</div>
				  </div>
				  <button class="carousel-control-prev" type="button" data-target="#carouselExampleCaptions" data-slide="prev">
					<span class="carousel-control-prev-icon" aria-hidden="true"></span>
					<span class="sr-only">Previous</span>
				  </button>
				  <button class="carousel-control-next" type="button" data-target="#carouselExampleCaptions" data-slide="next">
					<span class="carousel-control-next-icon" aria-hidden="true"></span>
					<span class="sr-only">Next</span>
				  </button>
				</div>		
		  </section>





  <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->

  <script src="../js/jquery-3.5.1.min.js"></script>

  <!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>

  <script src="../js/wow.min.js"></script>

  <!-- google-sign-in -->

  <script src="https://apis.google.com/js/platform.js" async defer></script>

  <script>

  	var uid; //傳遞至 api 更新使用

  	var flag_password = false;

  	var flag_checkpassword = false;



		$(function(){

			//password即時監聽

			$("#Updatepassword").bind("input propertychange", function(){

				if($(this).val().length == 8){

					$("#err_password").html("");

					flag_password = true;

				}else{

					$("#err_password").html("請輸入密碼8個字!");

					$("#err_password").css("color", "red");

					flag_password = false;

				}

			});



			//checkpassword即時監聽

  		$("#checkpassword").bind("input propertychange", function(){

  			if($(this).val() == $("#Updatepassword").val()){

  				$("#err_checkpassword").html("");

  				flag_checkpassword = true;

  			}else{

  				$("#err_checkpassword").html("密碼必須相同!");

  				$("#err_checkpassword").css("color", "red");

  				flag_checkpassword = false;

  			}

  		});



			//登出

			$("#Logout").bind("click",function(){

				setCookie("uuid", "", 0);

				location.href = "spa-20220214-1.html";

			});



			//回首頁

			$("#Home").bind("click",function(){

				location.href = "spa-20220214-1.html";

			});			



			//取消更新監聽

			$("#u_cancel_btn").bind("click",function(){

				location.href = "member-UserLogin2-Car.html";

			})



			//確認更新監聽

			$("#u_ok_btn").bind("click", function(){

				if(flag_password){

				console.log(uid);

				console.log($("#Updatepassword").val());

				//傳遞至 member_U_api.php

				var jsonData = {};

				jsonData["ID"] = uid;

				jsonData["Password"] = $("#Updatepassword").val();

				console.log(JSON.stringify(jsonData));

				$.ajax({

					type: "POST",

					url: "member-UU-api-Car.php",

					data: JSON.stringify(jsonData),

					dataType: "json",

					success: showdata_U,

					error: function(){

						alert("error-member-UU-api.php");

					}

				});

				}else{

					alert("格式輸入錯誤,請依照規則輸入!");

				}			

			});





			//驗證uuid是否為登入狀態

			if(getCookie("uuid") != ""){

				var jsondata = {};

				jsondata["uuid"] =  getCookie("uuid");

				$.ajax({

					type: "POST",

					url: "member-uuid-api-Car.php",

					data: JSON.stringify(jsondata),

					dataType: "json",

					success: showdata_check_uuid,

					error: function(){

						alert("error-member-uuid-api.php");

					}

				})

			}else{

				alert("請登入會員!");

				location.href = "spa-20220214-1.html";

			}

		})



		function showdata_check_uuid(data){

			console.log(data);

			if(data.state){

				// alert(data.message);

				if(data.data[0].Level ==1 || data.data[0].Level ==3){

					$("#username").html(data.data[0].Username);

					uid = data.data[0].ID; //更新密碼使用的uid

				}else{

					location.href = "member-UserLogin1-Car.html";

				}

			}else{

				alert(data.message);

				location.href = "spa-20220214-1.html";

			}

		}



		function showdata_U(data){

			console.log(data);

			if(data.state){

				alert(data.message);

				location.href = "member-UserLogin2-Car.html";

			}

		}

		function setCookie(cname, cvalue, exdays) {

			const d = new Date();

			d.setTime(d.getTime() + (exdays*24*60*60*1000));

			let expires = "expires="+ d.toUTCString();

			document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";

		}



		//取得Cookie

		function getCookie(cname) {

		  let name = cname + "=";

		  let decodedCookie = decodeURIComponent(document.cookie);

		  let ca = decodedCookie.split(';');

		  for(let i = 0; i <ca.length; i++) {

		    let c = ca[i];

		    while (c.charAt(0) == ' ') {

		      c = c.substring(1);

		    }

		    if (c.indexOf(name) == 0) {

		      return c.substring(name.length, c.length);

		    }

		  }

		  return "";

		}

  </script>

  <script>

  	new WOW().init();

  </script> 



</body>

</html>